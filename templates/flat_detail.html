{% extends 'base.html' %}
{% load static %}
{% block add_header_css %}
    {#    <link href="{% static '3dparty/galleria/themes/classic/galleria.classic.css' %}" rel="stylesheet">#}
    <link href="{% static '3dparty/galleria/themes/galleria-classicmod/galleria.classicmod.css' %}" rel="stylesheet">
{% endblock %}

{% block extra_footer_scripts %}
    <script type="text/javascript">
        var photos = {{ photos|safe }};
    </script>
    <script src="{% static '3dparty/galleria/galleria-1.4.2.min.js' %}" type="text/javascript"></script>
    <script src="{% static '3dparty/galleria/galleria-1.4.2.min.js' %}" type="text/javascript"></script>
    <script type="text/javascript">
        {#        Galleria.loadTheme('{% static '3dparty/galleria/themes/classic/galleria.classic.min.js' %}');#}
        Galleria.loadTheme('{% static '3dparty/galleria/themes/galleria-classicmod/galleria.classicmod.js' %}');
        Galleria.configure({
            transition: 'fade',
            imageCrop: false
        });
        Galleria.run('.galleria', {
            dataSource: photos
        });
        $(document).on('dblclick', '.galleria-image', function () {
            $('.galleria').data('galleria').toggleFullscreen();
        });

    </script>

    <script type="text/javascript">

    function init(){
        var myMap = new ymaps.Map("map", {
            center: [{{ flat.coords }}],
            zoom: 16
        });
        {% verbatim %}
        var MyBalloonContentLayoutClass = ymaps.templateLayoutFactory.createClass(
                '<h3>{{ properties.name }}</h3>' +
                '<p>Комнат: {{ properties.rooms }}</p>' +
                '<p>Метрополитен: {% if properties.metro %}да{% else %}нет{% endif %}</p>'
        );
     {% endverbatim %}
        var myPlacemark = new ymaps.Placemark(
                [{{ flat.coords }}],
                {
                    name: '{{ flat.title }}',
                    rooms: '{{ flat.rooms }}',
                    metro: true
                },
                {balloonContentLayout: MyBalloonContentLayoutClass}
        );
        myMap.geoObjects.add(myPlacemark);

    }
    ymaps.ready(init);
    </script>

{% endblock %}

{% block body %}
    <div class="col-md-8">
        <h1>{{ flat.title }}</h1>

        <div class="galleria" style="height: 450px;"></div>
        <br/>

{#        <div>{{ flat.description|safe }}</div>#}
    <div id="map" style="width: 100%; height: 400px"></div>
    </div>
    <div class="col-md-4 text-justify">
        {% include 'include/right_panel.html' %}
        <div>{{ flat.description|safe }}</div>
    </div>

{% endblock %}